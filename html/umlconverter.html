<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>UML Converter</title>
		<meta name="description" content="Converts UML syntax to Java code.">
		<meta name="keywords" content="UMLet, UML, Java, Convert, Diagram, Code">
		<meta property="og:title" content="UML Converter">
		<meta property="og:type" content="website">
		<meta property="og:url" content="https://mysterypancake.github.io/Fun/html/umlconverter">
		<meta property="og:site_name" content="UML Converter">
		<meta property="og:description" content="Converts UML syntax to Java code.">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<style>
		* {
			font-family: Arial, Helvetica, sans-serif;
		}

		html, body {
			height: 100%;
			margin: 0;
			overflow: hidden;
			padding: 0;
		}

		div {
			box-sizing: border-box;
			display: inline-block;
			float: left;
			height: 100%;
			width: 50%;
		}

		#umlbox {
			background-color: #DDDDDD;
			border: 1px solid black;
		}

		#uml {
			background: none;
			border: none;
			box-sizing: border-box;
			font-size: large;
			height: 100%;
			outline: none;
			padding: 8px;
			resize: none;
			width: 100%;
		}

		#code {
			background-color: black;
			color: white;
			font-size: medium;
			overflow: auto;
			padding: 16px;
			white-space: pre-wrap;
		}

		#code p {
			margin: 0;
			padding: 0;
		}
		</style>
		<script>
		let codeElem;

		function parseChars(str) {
			if (str === "--") return;
			let varScope = "public";
			let varName = "";
			let varType = "";
			let varValue = "";
			let varFinal = false;
			let mode = "name";
			let args = [];
			let currentArg;
			if (str.toLowerCase().indexOf("{read only}") !== -1) {
				varFinal = true;
				str = str.replace(/{read only}/gi, "");
			}
			for (let i = 0; i < str.length; i++) {
				const char = str.charAt(i);
				if (i === 0 && char === "+") {
					varScope = "public";
				} else if (i === 0 && char === "#") {
					varScope = "protected";
				} else if (i === 0 && char === "-") {
					varScope = "private";
				} else if (mode === "name") {
					if (char === ":") {
						mode = "type";
					} else if (char === "=") {
						mode = "value";
					} else if (char === "(") {
						currentArg = { name: "", type: "" };
						args.push(currentArg);
						mode = "argsname";
					} else {
						varName += char;
					}
				} else if (mode === "argsname") {
					if (char === ":") {
						mode = "argstype";
					} else if (char === ",") {
						currentArg = { name: "", type: "" };
						args.push(currentArg);
					} else if (char === ")") {
						mode = "name";
						currentArg = undefined;
					} else {
						currentArg.name += char;
					}
				} else if (mode === "argstype") {
					if (char === ")") {
						mode = "name";
						currentArg = undefined;
					} else if (char === ",") {
						currentArg = { name: "", type: "" };
						args.push(currentArg);
						mode = "argsname";
					} else {
						currentArg.type += char;
					}
				} else if (mode === "type") {
					if (char === "=") {
						mode = "value";
					} else {
						varType += char;
					}
				} else if (mode === "value") {
					varValue += char;
				}
			}
			let result = varFinal ? "final" : "";
			varType = varType.trim();
			if (varType) {
				result += " " + varType;
			}
			varName = varName.trim();
			if (varName) {
				result += " " + varName;
			}
			if (args.length) {
				result += "(";
				let randomChar = 97;
				for (let j = 0; j < args.length; j++) {
					let type = args[j].type.trim();
					let name = args[j].name.trim();
					if (name && !type) {
						type = name;
						name = String.fromCharCode(randomChar);
						randomChar++;
					}
					const combined = type + " " + name;
					if (j > 0) {
						result += ", ";
					}
					result += combined.trim();
				}
				result += ")";
			} else {
				varValue = varValue.trim();
				if (varValue) {
					result += " = " + varValue;
				}
			}
			const final = result.trim();
			if (final) {
				let result = "";
				if (args.length) {
					result += "\n";
				}
				result += "\t" + varScope + " " + final;
				if (args.length) {
					result += "\n\t{";
					// insert automatically determined parameters somehow
					result += "\n\t}";
				} else {
					result += ";";
				}
				return result;
			}
		}

		function update(elem) {
			let title = false;
			const lines = elem.value.split("\n");
			let result = "";
			while (lines.length > 0) {
				const line = lines.shift().trim();
				if (!line) continue;
				if (title) {
					const text = parseChars(line);
					if (text) {
						result += text + "\n";
					}
				} else {
					result += "public class " + line + "\n{\n";
					title = true;
				}
			}
			if (result) {
				result += "}";
			}
			codeElem.textContent = result;
		};

		function setup() {
			codeElem = document.getElementById("code");
		}
		</script>
	</head>
	<body onload="setup();">
		<div id="umlbox">
			<textarea id="uml" autocomplete="off" spellcheck="false" oninput="update(this);" autofocus></textarea>
		</div>
		<div id="code"></div>
	</body>
</html>